// Generated by CoffeeScript 1.6.3
(function() {
  $(function() {
    window.user = new window.models.User({
      id: window.userid
    });
    window.existingQueries = new window.collections.Queries();
    window.AllMaps = new collections.StoryMaps;
    return user.fetch({
      success: function(model) {
        return existingQueries.fetch({
          success: function(coll) {
            var map;
            console.log(user.toJSON());
            map = new models.StoryMap({
              queries: existingQueries
            });
            AllMaps.add(map);
            map.user = user;
            window.map = map = new views.MapItem({
              model: map
            });
            map.render();
            window.app = new window.Workspace({
              user: user,
              controller: map
            });
            return Backbone.history.start();
          }
        });
      }
    });
  });

}).call(this);
